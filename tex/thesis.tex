\input{preamble.tex}
%\input{titlepage.tex}

\begin{document}

\newgeometry{left=3cm}
	\include{titlepage-content}
\restoregeometry

\pagenumbering{roman}

\clearpage
\vspace*{\fill}
\begin{center}
	\begin{minipage}{.8\textwidth}
		\thispagestyle{empty} % no pagenumber on affidavit
		Diese Arbeit ist von mir selbst\"andig angefertigt und verfasst. Es sind keine anderen als die angegebenen Quellen und Hilfsmittel benutzt worden.\par
		\vspace{1cm}
		Frederic Klein \dotfill \par
		Unterschrift
	\end{minipage}
\end{center}
\vfill % equivalent to \vspace{\fill}
\clearpage

\spacing{1.5} % line spacing

\begin{abstract}
	\thispagestyle{plain}
	\setcounter{page}{1}
	In recent years gamification has become a part in many areas of our daily routine. In regard to our personal life, companies like Amazon or Runtastic can base their gamification approach on publicly sharing personal achievements and statistics to improve user commitment. In contrast, gamification concerning our work life has to satisfy much higher privacy demands. Since comparison is a key component for gamification, privacy protecting computations of system wide statistical values (for example minimum and maximum) are needed. The solution comes in the form of \gls{SMPC}, a subfield of cryptography. Existing frameworks for \gls{SMPC} utilize the Internet Protocol, though access to the Internet or even a \gls{LAN} cannot be provided in all environments. Facilities with sensible measuring systems, e.g. medical devices in hospitals, often avoid Wi-Fi to reduce the risk of electromagnetic interference.
	To be able to utilize \gls{SMPC} in environments with Wi-Fi restrictions, this thesis studies the characteristics of \gls{MANET} and proposes the design of a \gls{SMPC} framework for \gls{MANET}, especially based on Bluetooth technology, and the implementation as a C library. 
	
	Since \gls{MANET}s have a high probability for network partition, a centralized architecture for the computation and data preservation is unfavorable. Therefor a blockchain based distributed database is implemented in the framework. Typical problems of distributed systems are addressed with the implementation of algorithms for clock synchronization and coordinator election as well as protocols for the detection of computation partners and data distribution. Since the framework aims to provide distributed computations of comparable values, protocols for secure addition and secure comparison are implemented, enabling the computation of minimum, maximum and average.
	
	Devices of diverse computational power will be used to verify the applicability for wearables and \gls{IoT} grade devices. Also field-tests with a \gls{SPAN}(20-50 nodes) will be conducted to evaluated real life use cases. In contrast, the security of the framework and attack scenarios will be discussed. In summary, this thesis proposes a framework for \gls{SMPC} for decentralized, distributed systems.
\end{abstract}

\tableofcontents
\setcounter{page}{2}
\listoffigures
{\let\clearpage\relax \listoftables}

\printnoidxglossary[type=\acronymtype,title={List of Acronyms}]

{\let\clearpage\relax \printnoidxglossary[type=symbols,sort=letter]}

\chapter{Introduction\todo{5-10\%, including motivation, general audience}}
\pagenumbering{arabic}
In the last couple of years gamification has found it's way into many areas of our daily life. In regard to our personal life, companies like Amazon or Runtastic can base their gamification approach on publicly sharing personal achievements and statistics to improve user commitment. In contrast, gamification concerning our work life can have much higher privacy demands. Since comparison is a key component for the gamification approach, privacy protecting computations of system wide statistical values (for example minimum and maximum) are needed. The solution comes in the form of \gls{SMPC}, a subfield of cryptography.

Existing frameworks for \gls{SMPC} utilize the Internet protocol, though access to the Internet or even a \gls{LAN} cannot be provided in all environments. Especially many hospitals tend to avoid Wi-Fi to reduce the risk of electromagnetic interference with medical devices.

To be able to utilize \gls{SMPC} in environments with Wi-Fi restrictions, this thesis studies the characteristics of mesh-networks and proposes describes the design of a \gls{SMPC} framework for mesh-networks. 

Context

Restatement of the problem

Restatement of the response

Roadmap

	\section{Case Study: "The Hygiene Games"}

		\subsection*{Gamification}
	
		\subsection*{Wireless Networks in Hospitals}

\chapter{Background \todo{10-15\%; thorough review of the state of the art; informed audience}}
	
	\section{Secure Multi-Party Computation}

		\todo{general idea}
		
		\todo{introduce modulo for cryptography}
			
		\todo{discuss passive and active security}
		
		\todo{simple example}

		\subsection*{Secret Sharing}
		
		\textcite[p. \todo{compare to book version}]{Cra:1} describe secret sharing schemes as the main tool to build a \gls{SMPC} protocol with passive security. In 1979 Adi Shamir described a $(k, n)$ threshold scheme for sharing secret data $D$: "Our goal is to devide $D$ into $n$ pieces $D_i$, ..., $D_n$ in such a way that:
		(1) knowledge of any k or more $D_i$ pieces makes $D$ easily computable; (2) knowledge of any $k-1$ or fewer $D_i$ pieces leaves $D$ completely undetermined (in the sense that all its possible values are equally likely)." \autocite{Sha:1}
		Shamir's secret sharing scheme is based on polynomials of degree $k-1$ with $a_0=D$ (compare \ref{eq:polynomial}). 
		\begin{equation}
		\label{eq:polynomial}
		q(x)=D + a_1 \cdot x + ... + a_{k-1} \cdot x^{k-1}
		\end{equation}
		
		To divide $D$ into $n$ pieces the polynomial is evaluated: $D_i=q(i),\ i=1,...,n$.
		
		\todo{recombination with lagrange}
		
		For cryptographic protocols it is not practical to work with real arithmetic, instead a finite field is used. \textcite{Sha:1} specifies that modular instead of real arithmetic is used. A prime $p$ with $p>D, p>n$ is selected and used to define the set $[0, p)$. "The coefficients $a_1, ..., a_{k-1}$ in $q(x)$ are randomly chosen	from a uniform distribution over the integers in $[0, p)$, and the values $D_1, ..., D_n$ are computed modulo $p$." \autocite[p. 613]{Sha:1} (compare \ref{eq:polynomial modular})
		\begin{equation}
		\label{eq:polynomial modular}
		q(x) = D + a_1 \cdot x + ... + a_{k-1} \cdot x^{k-1} \mod p \qquad D,\ a_i \in [0,p)\ , \quad p \in \mathbb{P}
		\end{equation}
		\textcite[p. \todo{compare to book version 1.3.1}]{Cra:1} declare the set restricted by $p$ as $\mathbb{Z}_p = \{0, 1, ..., p-1\}$. They also use the notion \textit{secret S} for the data to be shared and \textit{shares $s_i$} for the computed pieces of the secret.
		
		\todo{describe number off messages, usage of threshold as tradeoff between security and performance}
				
		The reconstruction of a secret $S$ can be done using Lagrange interpolation (compare \ref{eq:SSS lagrange interpolation}).
		\begin{equation}
		\label{eq:SSS lagrange interpolation}
		S = \sum_i s_i \prod_{i \neq j} \frac{-x_j}{x_i-x_j} \mod p
		\end{equation}
		 $k$ shares $s_i$ are needed to reconstruct $S$, so only the associated values for $i$ are used in the Lagrange interpolation.
						
		\subsubsection{Example Computation}
		
		Consider the following task: a secret $S=8$ is supposed to be shared among $n=4$ parties $P_i$. The threshold for the number of needed shares for the reconstruction of the secret shall be $k=3$ (public).
		
		First a prime $p$ has to be chosen, which has to be larger than the secret ($p>S$) and the number of parties ($p>n$): $p=17$ (public)
		
		Since $k=3$, the polynomial has a degree of $k-1=2$ (compare \ref{eq:SSS example polynomial}).
		\begin{equation}
		\label{eq:SSS example polynomial}
		f(x) = S + a_1 \cdot x + a_2 \cdot x^2 \mod p
		\end{equation}
		 
		 The coefficients are selected randomly uniformly out of $\mathbb{Z}_p=\{0,1,...,p-1\}=\{0,1,...,16\}$: $a_1=13$ and $a_2=4$ and the shares $s_i$ are computed (compare \ref{eq:SSS example polynomial specific}).
		 \begin{alignat}{1}
		 & f(x) = 8 + 13 \cdot x + 4 \cdot x^2 \mod 17 \label{eq:SSS example polynomial specific} \\
		 &\qquad \qquad \qquad \quad \Downarrow \nonumber \\ 
		 & f(x_1)=f(1)=25\mod17=8=s_1 \nonumber \\
		 & f(x_2)=f(2)=50\mod17=16=s_2 \nonumber \\
		 & f(x_3)=f(3)=83\mod17=15=s_3 \nonumber \\
		 & f(x_4)=f(4)=124\mod17=5=s_4 \nonumber 
		 \end{alignat}
		 
		 If parties $P_2$, $P_3$ and $P_4$ pool their shares, they can reconstruct the secret S using Lagrange interpolation (using also the public information: $p=17$):
		 \begin{alignat}{2}
		 & S = && \sum_i s_i \prod_{i \neq j} \frac{-x_j}{x_i - x_j } \mod 17 \qquad \qquad  with \ i,j \in \{2,3,4\} \\
		 & \quad && =s_2 \cdot \frac{-x_3}{x_2-x_3} \cdot \frac{-x_4}{x_2-x_4} + s_3 \cdot \frac{-x_2}{x_3-x_2} \cdot \frac{-x_4}{x_3-x_4} + s_4 \cdot \frac{-x_2}{x_4-x_2} \cdot \frac{-x_3}{x_4-x_3} \mod 17 \nonumber \\
		 & \quad && =16 \cdot \frac{-3}{2-3} \cdot \frac{-4}{2-4} + 15 \cdot \frac{-2}{3-2} \cdot \frac{-4}{3-4} + 5 \cdot \frac{-2}{4-2} \cdot \frac{-3}{4-3} \mod 17  \nonumber \\
		 & \quad && = 96-120+15 \mod 17 \nonumber \\
		 & \quad && = -9 \mod 17 \label{eq:SSS example negative modulo} \\
		 & \quad && = 8 \nonumber 
		 \end{alignat}
		 \textit{Note:} in cryptography $a \mod n$ for $a<0$ (negative dividend) is calculated by adding a multiple of  $n$, so that $m*n+a>0$: e.g. $-9 \mod 17 = (17-9) \mod 17$ (compare \ref{eq:SSS example negative modulo}).
		 
		 
		 
		 
		 		
		\subsection*{Random Numbers}
		
		\todo{random numbers important for cryptography: selection of coefficients in secret sharing, public key generation, ...}

		
		
		
		Citation test \autocite[pp. 35-37]{Cra:1}.

		\subsection*{Differential Privacy}
		
		\subsection*{Secure Addition Protocol}

		\subsection*{Secure Comparison Protocol}

		\subsection*{Existing Frameworks}
	
	\section{Mobile Ad Hoc Networks}
	
			{\color{gray} 
				\begin{itemize}  
					\item continuously self-configuring
					\item self-forming
					\item self-healing
					\item infrastructure-less
					\item peer-to-peer
					\item Difference to mesh: mobility of nodes
				\end{itemize}
			}
	
		\todo{Example: firechat in SPAN}
		
			\subsection*{Comparison to Wi-Fi Direct}
			
				{\color{gray} 
					\begin{itemize}  
						\item SPAN support multi-hop relays
						\item Wi-Fi Direct since Android 4.0
						\item Wi-Fi Direct: Soft AP 
					\end{itemize}
				}
		
			\subsection*{Bluetooth Based \gls{MANET} }

			\subsection*{Wi-Fi Based \gls{MANET}}
	
\chapter{Design \todo{15-20\%; explains complete processing chain; explains what methods are used; for someone that wants to know what was done in detail}}

	\section{Requirements}
	
		\todo{use cases, process description, resulting requirements}

	\section{Distributed Computing}

		\subsection*{Coordinator Election}
		
		\subsection*{Clock Synchronization}
		
		\subsection*{Distributed Databases}
		
	\section{Applicability of \gls{SMPC} Protocols in \gls{MANET}s}
	
		\subsection*{Analysis of Key Factors: Computing Power, Network Data Rates and Duration of Connection}
		
		\subsection*{Effectiveness of \gls{SMPC} Protocols in Sparse Networks}
		
			\subsubsection*{Maintaining anonymity}
		
			\subsubsection*{Strategies for Aggregation of Participants in Sparse Networks}
			
	\section{Architecture}
	
			\todo{UML; module structure}

\chapter{Implementation \todo{15-20\%; details on the implementation; for someone who wants to continue the work}}	

	%\section{Development Tools}
	
	\section{Communication Layer}
	
			\subsection*{Pairing-less Connection}
			
			\subsection*{Secure Channel}
			
	\section{\gls{SMPC} Module}
	
	\section{Data Storage and Distribution}
	
	\section{Interfacing the Library}
	
		\subsection*{Configuration}
		
		\subsection*{Usage in C}
		
		\subsection*{Usage in Android}
		
\chapter{Evaluation \todo{5-15\%; outcome; how was it tested; for supervisor}}

	\section{Testing Tools}
	
		\todo{CUnit; JUnit; Simulation?}

	\section{Examination of Computation Time Dependent on Computing Power}
	
	\section{Examination of Computation Time Dependent on Number of Participants}
	
		%\todo{SNET with increasing number of android devices; predefined tests}
		
	%\section{Examination of Distribution Time Dependent on Number of Participants}

\chapter{Discussion \todo{5-15\%; outcome for a design-reader} }

\chapter{Conclusion \todo{5-10\%; outcome for a introduction-reader}}

\clearpage
\renewcommand{\bibname}{References} % rename Bibliograpy to References
\printbibliography[heading=bibintoc] % add References chapter and display it in toc

\begin{appendices}
	\chapter{Some name}
	\lipsum[3]
\end{appendices}

\end{document}